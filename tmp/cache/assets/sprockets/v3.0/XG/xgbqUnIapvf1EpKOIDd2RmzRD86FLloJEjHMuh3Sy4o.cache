I"!	(function() {
  window.ExpensiveIndexController = (function(expensiveServices) {
    var doneLoadSubcategories, failLoadSubcategories, init, loadSubcategories, showNewExpensive, subCategorySelect;
    subCategorySelect = $("#expensive_category_id");
    init = function() {
      $(document).on("click", "#btnAddNewExpensive", showNewExpensive);
      $(document).on('change', "#expensive_category_id", loadSubcategories);
    };
    showNewExpensive = function() {
      console.log("btn click");
      expensiveServices.createNewExpensive(doneLoadSubcategories, failLoadSubcategories);
    };
    doneLoadSubcategories = function(html) {
      var dialog;
      dialog = bootbox.dialog({
        title: "New Expensive",
        message: html,
        closeButton: true
      });
      dialog.init(function() {
        $(".bootbox").removeAttr("tabindex");
        $('select').select2({
          theme: 'bootstrap'
        });
        $("span.select2.select2-container").removeAttr("style");
        return $(".select2 .select2-container").css("width", "100%");
      });
    };
    failLoadSubcategories = function(err) {
      console.log(err);
    };
    loadSubcategories = function() {
      var categoryId;
      subCategorySelect.empty();
      subCategorySelect.select2({
        placeholder: "Select a Subcategory"
      });
      categoryId = subCategorySelect.val();
      console.log(categoryId);
      expensiveServices.loadSubcategories(categoryId);
    };
    doneLoadSubcategories = function(data) {
      var category, subcategories;
      subCategorySelect.select2({
        theme: "bootstrap"
      }, category = JSON.parse(data), subcategories = category["Subcategory"], subcategories.length > 0 ? ($(".js-new-subcategory").hide(), subCategorySelect.prop('disabled', false), $.each(subcategories, function(index) {
        return subCategorySelect.append("<option value=" + subcategories[index]["id"] + ">" + subcategories[index]["Name"] + "</option>");
      })) : (subCategorySelect.append("<option value='-1'> Subcategory is requierd</option>"), subCategorySelect.prop('disabled', true), $(".js-new-subcategory").show()));
    };
    failLoadSubcategories = function(err) {
      $('body').append("AJAX Error: " + err);
    };
    return {
      init: init
    };
  })(window.ExpensiveServices);

}).call(this);
:ET